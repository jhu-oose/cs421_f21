"use strict";(self.webpackChunkcs_421_source=self.webpackChunkcs_421_source||[]).push([[7027],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var i=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,i,o=function(e,t){if(null==e)return{};var a,i,o={},n=Object.keys(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=i.createContext({}),d=function(e){var t=i.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=d(a),h=o,u=m["".concat(l,".").concat(h)]||m[h]||p[h]||n;return a?i.createElement(u,r(r({ref:t},c),{},{components:a})):i.createElement(u,r({ref:t},c))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,r=new Array(n);r[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var d=2;d<n;d++)r[d]=a[d];return i.createElement.apply(null,r)}return i.createElement.apply(null,a)}m.displayName="MDXCreateElement"},6461:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>n,metadata:()=>s,toc:()=>d});var i=a(7462),o=(a(7294),a(3905));const n={id:"refactoring",title:"Refactoring",sidebar_label:"Refactoring"},r=void 0,s={unversionedId:"readings/wk2/refactoring",id:"readings/wk2/refactoring",title:"Refactoring",description:"Design principles are guidelines; they are not laws! As with everything in life, you can go too far with applying these principles at the cost of making a design more complicated than it should be. You should try to be pragmatic and don't take these principles as dogma!",source:"@site/docs/readings/wk2/refactoring.md",sourceDirName:"readings/wk2",slug:"/readings/wk2/refactoring",permalink:"/cs421/docs/readings/wk2/refactoring",draft:!1,editUrl:"https://jhu-oose.github.io/cs421_f21/docs/readings/wk2/refactoring.md",tags:[],version:"current",frontMatter:{id:"refactoring",title:"Refactoring",sidebar_label:"Refactoring"},sidebar:"tutorialSidebar",previous:{title:"Object-Oriented Programming",permalink:"/cs421/docs/readings/wk2/oop"},next:{title:"Single Responsibility Principle",permalink:"/cs421/docs/readings/wk2/srp"}},l={},d=[{value:"Code Smell: Large Class",id:"code-smell-large-class",level:2},{value:"Code Smell: Long Methods",id:"code-smell-long-methods",level:2},{value:"Code Smell: Data Clumps",id:"code-smell-data-clumps",level:2},{value:"Code Smell: Duplicate Code",id:"code-smell-duplicate-code",level:2},{value:"Code Smell: Primitive Obsession",id:"code-smell-primitive-obsession",level:2}],c={toc:d};function p(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,i.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Design principles are guidelines; they are not laws! As with everything in life, you can go too far with applying these principles at the cost of making a design more complicated than it should be. ",(0,o.kt)("strong",{parentName:"p"},"You should try to be pragmatic and don't take these principles as dogma!")),(0,o.kt)("p",null,"One strategy to keep the balance is to start simple (with a good enough design) but be prepared to ",(0,o.kt)("em",{parentName:"p"},"refactor")," as you progress. In his classic book, ",(0,o.kt)("a",{parentName:"p",href:"https://martinfowler.com/books/refactoring.html"},"Refactoring"),", Martin Fowler defines refactoring as:"),(0,o.kt)("admonition",{title:"Software Refactoring",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The process of changing a software system in such a way hat it does not alter the external behavior of the code yet improves its internal structure.")),(0,o.kt)("p",null,"It may surprise you to learn ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Software_rot"},"software rots"),"! It rots because of improper design; because over time, easy code changes are made instead of difficult design changes. ",(0,o.kt)("strong",{parentName:"p"},"Refactoring is the art of making design changes over time to keep the software fit for its purpose and ready for more changes."),"\nIt takes attention; one must be able to recognize the ",(0,o.kt)("em",{parentName:"p"},"smell")," of (software) rot to act in time."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},'Code smells are structures in the code that indicate violation of design principles and negatively impact software quality. In other words, "a code smell is a surface indication that usually corresponds to a deeper problem in the system."')),(0,o.kt)("p",null,"Exploring code smells in details and possible refactorings for each smell is beyond the scope of this course. We will just quickly review some of the very common code smells and their possible fixes. If you would like to learn further about code smell and their treatments, you can start ",(0,o.kt)("a",{parentName:"p",href:"https://refactoring.guru/refactoring/smells"},"here"),"."),(0,o.kt)("h2",{id:"code-smell-large-class"},"Code Smell: Large Class"),(0,o.kt)("admonition",{title:"Code Smell: Large Class",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"A class contains many fields/methods/lines of code.")),(0,o.kt)("p",null,"It it mentally less taxing to place a new feature in an existing class than to create a new class for the feature. So, classes usually start small, but over time as the program matures, they get bloated. It's like the ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Hotel_California"},"Hotel California"),"; something is always being added to a class but nothing is ever taken out!"),(0,o.kt)("admonition",{title:"Fix",type:"tip"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"When a class is (or is about to get) bloated, it is likely having too many responsibilities. Consider splitting it up into separate (smaller and more cohesive) components (think Single Responsibility Principle). "),(0,o.kt)("li",{parentName:"ul"},"If the the issue is not extra responsibilities but more so about handling special cases, consider extracting subclasses (think Open/Closed Principle). "),(0,o.kt)("li",{parentName:"ul"},"In the latter case, it makes for a better design to create abstractions (interfaces) to keep the inheritance hierarchies flat (think Dependency Inversion and Interface Segregation principles)."))),(0,o.kt)("h2",{id:"code-smell-long-methods"},"Code Smell: Long Methods"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},'If it is not possible to view the whole method on your 5" smartphone screen, the method is most likely a long method.')),(0,o.kt)("p",null,"The majority of a programmer's time is spent reading code rather than writing code. Apart from the difficulty of having to keep a lot of complex logic in mind whilst reading through a long method, it is usually a sign that the method has too many responsibilities. Long methods make code be hard to maintain and debug."),(0,o.kt)("admonition",{title:"Fix",type:"tip"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"break the long method into two or more smaller methods, each doing one precise thing (apply single responsibility at method level.)"),(0,o.kt)("li",{parentName:"ul"},"Sometimes, you have a long method where the local variables are so intertwined that it is not straightforward to break the method down into several methods; Instead, it might make sense to transform the method into a separate class so that the local variables become fields of the class. Then you can split the method into several methods within the same class."))),(0,o.kt)("h2",{id:"code-smell-data-clumps"},"Code Smell: Data Clumps"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},'"data clump" is a name given to any group of variables which are passed around together (in a clump) throughout various parts of the program. This for example happens where multiple method calls take the same set of parameters.')),(0,o.kt)("p",null,"Data clumps may be a sign that these parameters are related. As an example, consider the following three method calls:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"public void AddDataItem(int xCord, int yCord, int zCord) { ... }\npublic void removeDataItem(int xCord, int yCord, int zCord) { ... }\npublic void updateDataItem(int xCord, int yCord, int zCord) { ... }\n")),(0,o.kt)("p",null,"All the three methods receive x, y and z coordinate values to add/update/remove a data point. ",(0,o.kt)("inlineCode",{parentName:"p"},"xCord"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"yCord")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"zCord")," here can be considered a data clump. Possible remedies are:"),(0,o.kt)("admonition",{title:"Fix",type:"tip"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"If the same data clumps are passed as arguments into the parameters of methods, it can be useful to combine them together in a class to keep the group of parameters together."),(0,o.kt)("li",{parentName:"ul"},"If repeating data comprises the fields of a class, considert extracting those fields into a separate class of their own."))),(0,o.kt)("h2",{id:"code-smell-duplicate-code"},"Code Smell: Duplicate Code"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"It's been known for a developer to fix a bug, only for the same symptoms to then resurface in a slightly different part of the system. This can be the result of code duplication, and a bug being fixed in one occurrence of the imperfect code but not in the duplicated versions.")),(0,o.kt)("p",null,"Code duplicates pose an overhead in terms of testing, debugging and maintenance. When developers are not aware of the duplication, they only know to fix the occurrence they have come across. Always, be on the lookout for repeated code blocks and extract them out into a single place."),(0,o.kt)("admonition",{title:"fix",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Depending where/how the code appears, you can remedy it in different ways. The general idea is to move the duplication(s) into a single place. "),(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"If there are code duplication across two subclasses, consider moving the duplicated code into the parent class."),(0,o.kt)("li",{parentName:"ul"},"If there are code duplication across two separate parts of the code, consider extracting the duplicate code into a stand-alone method."))),(0,o.kt)("admonition",{title:"Extra Tip",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"There is in fact a design principle named DRY that is sometimes listed along with SOLID principles. DRY is short for Don't Repeat Yourself which essentially means avoid duplicate code by abstracting out things that are common and place those things in a single location.")),(0,o.kt)("h2",{id:"code-smell-primitive-obsession"},"Code Smell: Primitive Obsession"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Primitive types give little in terms of domain context. If primitives have a domain meaning, wrap them in a small class to represent the idea. ")),(0,o.kt)("p",null,"Sometimes you are tempted to use primitives instead of small objects for simple tasks such as currency, email address, zip code, ranges, phone numbers, etc. This typically happens becuase creating a primitive field is so much easier than making a whole new class, right?"),(0,o.kt)("admonition",{title:"fix",type:"tip"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"If you have a large variety of primitive fields, it may be possible to logically group some of them into their own class. "),(0,o.kt)("li",{parentName:"ul"},"Even better, move the behavior associated with this data into the class too."))))}p.isMDXComponent=!0}}]);